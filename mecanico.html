<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Execu√ß√£o de Manuten√ß√£o - Magno</title>
    <style>
        body { font-family: sans-serif; background: #2c3e50; color: white; padding: 20px; }
        .card { background: white; color: #333; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        input, textarea { width: 100%; padding: 8px; margin: 5px 0 15px 0; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        button { width: 100%; background: #27ae60; color: white; padding: 15px; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; }
        .label-doc { background: #eee; padding: 5px; font-weight: bold; display: block; margin-bottom: 10px; border-left: 4px solid #27ae60; }
    </style>
</head>
<body>

<h1>üë®‚Äçüîß Execu√ß√£o de Manuten√ß√£o</h1>
<div id="lista-mecanico">Aguardando ordens...</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
    const firebaseConfig = {
        apiKey: "AIzaSyBUUadtzPAVUYsROQ87Vd7G96EkbQDniqc",
        authDomain: "magno-10b0d.firebaseapp.com",
        databaseURL: "https://magno-10b0d-default-rtdb.firebaseio.com",
        projectId: "magno-10b0d",
        storageBucket: "magno-10b0d.firebasestorage.app",
        messagingSenderId: "455121182342",
        appId: "1:455121182342:web:13ba1fc65fd95256c9fb07"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    db.ref('ordens').on('value', (snap) => {
        const lista = document.getElementById('lista-mecanico');
        lista.innerHTML = '';
        const data = snap.val();
        for(let id in data) {
            const os = data[id];
            if(os.status === 'Conclu√≠do') continue;

            lista.innerHTML += `
                <div class="card">
                    <span class="label-doc">SOLICITA√á√ÉO: ${os.tipoServico}</span>
                    <p><b>Setor:</b> ${os.setor} | <b>Equipamento:</b> ${os.equipamento}</p>
                    <p><b>Motivo:</b> ${os.motivo}</p>
                    <hr>
                    <label>Executante:</label>
                    <input type="text" id="exec-${id}">
                    <label>Hora In√≠cio:</label>
                    <input type="time" id="ini-${id}">
                    <label>Hora Fim:</label>
                    <input type="time" id="fim-${id}">
                    <label>Servi√ßo Executado:</label>
                    <textarea id="serv-${id}"></textarea>
                    <label>Material Utilizado:</label>
                    <textarea id="mat-${id}"></textarea>
                    <button onclick="finalizar('${id}')">FINALIZAR MANUTEN√á√ÉO</button>
                </div>
            `;
        }
    });

    window.finalizar = (id) => {
        db.ref('ordens/' + id).update({
            executante: document.getElementById('exec-'+id).value,
            horaInicio: document.getElementById('ini-'+id).value,
            horaFim: document.getElementById('fim-'+id).value,
            servicoExecutado: document.getElementById('serv-'+id).value,
            materialUtilizado: document.getElementById('mat-'+id).value,
            status: 'Conclu√≠do'
        });
        alert("Manuten√ß√£o Finalizada!");
    };
</script>
</body>
</html>