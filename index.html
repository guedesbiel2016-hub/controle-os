<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recep√ß√£o - Magno</title>
    <style>
        :root {
            --pendente: #fff3cd; --texto-pendente: #856404;
            --concluido: #d4edda; --texto-concluido: #155724;
        }
        body { font-family: 'Segoe UI', sans-serif; background: #f8f9fa; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .container { display: flex; gap: 20px; width: 100%; max-width: 1100px; flex-wrap: wrap; }
        .coluna { flex: 1; min-width: 320px; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        h1 { color: #333; margin-bottom: 30px; }
        h2 { border-bottom: 2px solid #eee; padding-bottom: 10px; font-size: 1.2em; }
        input, textarea { width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        .btn-abrir { width: 100%; padding: 15px; background: #007bff; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
        
        .card-os { padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 6px solid; position: relative; }
        .os-pendente { background: var(--pendente); color: var(--texto-pendente); border-color: #ffc107; }
        .os-concluida { background: var(--concluido); color: var(--texto-concluido); border-color: #28a745; }
        
        .obs-tecnica { background: rgba(255,255,255,0.5); padding: 10px; border-radius: 5px; margin-top: 10px; border: 1px dashed #999; font-size: 0.9em; }
        .btn-del { position: absolute; top: 10px; right: 10px; background: none; border: none; cursor: pointer; color: #cc0000; font-weight: bold; }
    </style>
</head>
<body>

    <h1>üìã Recep√ß√£o - Controle de Ordens</h1>

    <div class="container">
        <div class="coluna">
            <h2>Abrir Nova OS</h2>
            <input type="text" id="cliente" placeholder="Nome do Cliente / Ve√≠culo">
            <textarea id="problema" rows="3" placeholder="Relato do cliente..."></textarea>
            <button class="btn-abrir" id="btnSalvar">GERAR ORDEM DE SERVI√áO</button>
        </div>

        <div class="coluna">
            <h2>Status da Oficina</h2>
            <div id="lista-os">Conectando...</div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBUUadtzPAVUYsROQ87Vd7G96EkbQDniqc",
            authDomain: "magno-10b0d.firebaseapp.com",
            databaseURL: "https://magno-10b0d-default-rtdb.firebaseio.com",
            projectId: "magno-10b0d",
            storageBucket: "magno-10b0d.firebasestorage.app",
            messagingSenderId: "455121182342",
            appId: "1:455121182342:web:13ba1fc65fd95256c9fb07",
            measurementId: "G-XNQGHWBLGC"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // SALVAR NOVA OS
        document.getElementById('btnSalvar').onclick = () => {
            const cliente = document.getElementById('cliente').value;
            const problema = document.getElementById('problema').value;
            if(!cliente || !problema) return alert("Preencha tudo!");

            db.ref('ordens').push({
                cliente, problema, status: 'Aberto', data: new Date().toLocaleString('pt-BR')
            });

            document.getElementById('cliente').value = '';
            document.getElementById('problema').value = '';
        };

        // MONITORAR EM TEMPO REAL
        db.ref('ordens').on('value', (snapshot) => {
            const listaDiv = document.getElementById('lista-os');
            listaDiv.innerHTML = '';
            const dados = snapshot.val();

            if(!dados) { listaDiv.innerHTML = "Nenhuma ordem no momento."; return; }

            Object.keys(dados).reverse().forEach(id => {
                const os = dados[id];
                const statusClasse = os.status === 'Aberto' ? 'os-pendente' : 'os-concluida';
                
                const card = document.createElement('div');
                card.className = `card-os ${statusClasse}`;
                card.innerHTML = `
                    <button class="btn-del" onclick="excluir('${id}')">X</button>
                    <strong>üë§ ${os.cliente}</strong><br>
                    <small>Entrada: ${os.data}</small>
                    <p><b>Problema:</b> ${os.problema}</p>
                    ${os.status === 'Conclu√≠do' ? 
                        `<div class="obs-tecnica"><b>‚úÖ Relat√≥rio do Mec√¢nico:</b><br>${os.observacao}</div>` : 
                        `<i>‚è≥ Aguardando oficina...</i>`}
                `;
                listaDiv.appendChild(card);
            });
        });

        window.excluir = (id) => { if(confirm("Apagar registro?")) db.ref('ordens/' + id).remove(); };
    </script>
</body>
</html>