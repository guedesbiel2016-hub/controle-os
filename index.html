<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abertura de OS - Magno</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f4f7f6; padding: 20px; }
        .container { max-width: 800px; margin: auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: #333; border-bottom: 2px solid #007bff; padding-bottom: 10px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        label { font-weight: bold; display: block; margin-bottom: 5px; color: #555; }
        input, select, textarea { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; }
        .full { grid-column: span 2; }
        button { width: 100%; padding: 15px; background: #007bff; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 20px; font-size: 16px; }
        .card-os { background: #fffde7; padding: 15px; border-radius: 8px; margin-top: 20px; border-left: 5px solid #fbc02d; }
    </style>
</head>
<body>

<div class="container">
    <h2>Abertura de Ordem de Serviço</h2>
    <div class="grid">
        <div>
            <label>Setor:</label>
            <input type="text" id="setor">
        </div>
        <div>
            <label>Solicitante:</label>
            <input type="text" id="solicitante">
        </div>
        <div class="full">
            <label>Equipamento/Máquina:</label>
            <input type="text" id="equipamento">
        </div>
        <div>
            <label>Máquina Parada?</label>
            <select id="parada">
                <option value="Não">Não</option>
                <option value="Sim">Sim</option>
            </select>
        </div>
        <div>
            <label>Tipo de Serviço:</label>
            <select id="tipoServico">
                <option value="Predial">Predial</option>
                <option value="Elétrica">Elétrica</option>
                <option value="Melhoria">Melhoria</option>
                <option value="Corretiva">Corretiva</option>
                <option value="Preventiva">Preventiva</option>
            </select>
        </div>
        <div class="full">
            <label>Motivo/Descrição do Problema:</label>
            <textarea id="motivo" rows="3"></textarea>
        </div>
    </div>
    <button id="btnEnviar">GERAR ORDEM DE SERVIÇO</button>

    <div id="monitoramento">
        <h3>Ordens em Andamento</h3>
        <div id="lista-os">Carregando...</div>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
    const firebaseConfig = {
        apiKey: "AIzaSyBUUadtzPAVUYsROQ87Vd7G96EkbQDniqc",
        authDomain: "magno-10b0d.firebaseapp.com",
        databaseURL: "https://magno-10b0d-default-rtdb.firebaseio.com",
        projectId: "magno-10b0d",
        storageBucket: "magno-10b0d.firebasestorage.app",
        messagingSenderId: "455121182342",
        appId: "1:455121182342:web:13ba1fc65fd95256c9fb07"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    document.getElementById('btnEnviar').onclick = () => {
        const dados = {
            setor: document.getElementById('setor').value,
            solicitante: document.getElementById('solicitante').value,
            equipamento: document.getElementById('equipamento').value,
            parada: document.getElementById('parada').value,
            tipoServico: document.getElementById('tipoServico').value,
            motivo: document.getElementById('motivo').value,
            status: 'Aberto',
            dataAbertura: new Date().toLocaleString('pt-BR')
        };
        db.ref('ordens').push(dados);
        alert("OS Enviada!");
    };

    db.ref('ordens').on('value', (snap) => {
        const lista = document.getElementById('lista-os');
        lista.innerHTML = '';
        const data = snap.val();
        for(let id in data) {
            const os = data[id];
            lista.innerHTML += `<div class="card-os">
                <b>Setor:</b> ${os.setor} | <b>Máquina:</b> ${os.equipamento}<br>
                <b>Status:</b> ${os.status} ${os.status === 'Concluído' ? '✅' : '⏳'}
            </div>`;
        }
    });
</script>
</body>
</html>